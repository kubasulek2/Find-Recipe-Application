{"version":3,"sources":["app.js"],"names":["$","request","restriction","undefined","filter","ingredient1","ingredient2","ingredient3","requestFetch","url","toLowerCase","redirect","query","headers","then","json","createRecipeCard","data","catch","array","console","log","err","result","push","length","hits","index","castRecipes","drawRecipeData","random","changeRecipe","maxIndex","clearRecipeData","recipe","image","Image","calories","yield","Math","append","label","text","attr","i","recipeNumber","ingredients","one","empty","door","on","handle","async","Object","keys","forEach","key","find","removeClass","val","handleBack","Promise","resolve","setTimeout","animationEnd","toggleClass","openFridge","prev","this","parent","previousElementSibling","id","includes"],"mappings":"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","file":"app.js","sourcesContent":["$(() => {\n  let request = {\n    restriction: undefined,\n    filter: undefined,\n    ingredient1: undefined,\n    ingredient2: undefined,\n    ingredient3: undefined\n  };\n  const createRequest = () => {\n\n    request.restriction = $('.restriction').text() === 'No restriction' ? undefined : $('.restriction').text();\n    request.filter = $('.filter').text() === 'No filter' ? undefined : $('.filter').text();\n    request.ingredient1 = $('#ingredient-1').val() === ''? undefined : $('#ingredient-1').val();\n    request.ingredient2 = $('#ingredient-2').val() === ''? undefined : $('#ingredient-2').val();\n    request.ingredient3 = $('#ingredient-3').val() === ''? undefined : $('#ingredient-3').val();\n\n    requestFetch(request)\n  };\n\n  const resetRequest = ()=>{\n\n    Object.keys(request).forEach((key)=> request[key] = undefined);\n    $('.fridge').find('.dropdown-menu .show').removeClass('show');\n    $('.fridge').find('input').val('');\n    $('.restriction').text('No restriction');\n    $('.filter').text('No filter')\n  };\n\n\n  const handleSelection = ()=> {\n    \n    $('a.dropdown-item').on('click', function () {\n      $(this).parent().prev().text($(this).text())\n    });\n    \n    $('.fa-times-circle').on('click', function () {\n      $(this).prev().val('');\n\n      request.ingredient1 = this.previousElementSibling.id.includes('1') ? undefined : request.ingredient1;\n      request.ingredient2 = this.previousElementSibling.id.includes('2') ? undefined : request.ingredient2;\n      request.ingredient3 = this.previousElementSibling.id.includes('3') ? undefined : request.ingredient3;\n    })\n  };\n\n\n  const openFridge = ()=>{\n    const door = $('.door');\n    const handle = $('.handle');\n\n    door.on('click', async function () {\n      resetRequest();\n      handle.addClass('open');\n\n      let handleBack = new Promise(resolve =>setTimeout(()=>resolve( handle.removeClass('open') ),300) );\n      let animationEnd = new Promise(resolve =>setTimeout(()=>resolve(),600) );\n\n      await handleBack;\n      await animationEnd;\n\n      door.toggleClass('open');\n    })\n  };\n  const requestFetch = request =>{\n    const appId = 'fd3ea657';\n    const appKey ='a61ca3c11d3b2ec930779e11cfe06c85';\n    let query = createQuery();\n\n    let filter = request.filter === undefined ? '' : `&diet=${request.filter.toLowerCase()}`;\n    let restriction = request.restriction === undefined ? '' : `&health=${request.restriction.toLowerCase()}`;\n    let url = `https://api.edamam.com/search?q=${query}&app_id=${appId}&app_key=${appKey}${filter}${restriction}&from=0&to=100`;\n\n    fetch(url,{\n      mode: 'cors',\n      redirect: 'follow',\n      headers: {\n        'Accept-Encoding': 'gzip',\n      }\n    }).then(resp => resp.json())\n      .then(data =>{\n        //console.log(data);\n        createRecipeCard(data);\n      })\n      .catch(err => console.log(err))\n\n\n  };\n\n  const createQuery = () => {\n    let array = [];\n    let result ='';\n    if( request.ingredient1 !== undefined) {array.push(request.ingredient1)}\n    if( request.ingredient2 !== undefined) {array.push(request.ingredient2)}\n    if( request.ingredient3 !== undefined) {array.push(request.ingredient3)}\n    if (array.length === 3){ result = `${array[0]}+${array[1]}+${array[2]}`}\n    if (array.length === 2){ result = `${array[0]}+${array[1]}`}\n    if (array.length === 1){ result = `${array[0]}`}\n    return result\n  };\n\n  const createRecipeCard = data => {\n    let length = data.hits.length > 4 ? 4 : data.hits.length;\n    let index = castRecipes(data.hits.length);\n    let maxIndex = index + length;\n    drawRecipeData(data, index, maxIndex);\n  };\n\n  const castRecipes = (index) => {\n    return index <= 5 ? 0 : Math.floor(Math.random()*(index - 4))\n  };\n\n  const changeRecipe = (data, index,maxIndex) => {\n    drawRecipeData(data, index,maxIndex);\n\n  };\n\n  const drawRecipeData = (data, index, maxIndex) => {\n    clearRecipeData();\n    //console.log(data);\n    let recipe = data.hits[index].recipe;\n    let image = new Image();\n    let calories = Math.round(recipe.calories / recipe.yield);\n    let recipeNumber = -(maxIndex-(index+5));\n\n\n    image.src = recipe.image;\n    image.onload = $('.image')\n      .append(`<img src='${image.src}' class=\"card-img-top mx-auto\" alt=\"recipe image\">`);\n\n    $('.card-title').text(recipe.label);\n    $('.group-info .info-1').text(`Servings: ${recipe.yield}`);\n    $('.group-info .info-2').text(`Cal/Serving: ${calories}`);\n    $('.index').text(`${recipeNumber}/5`);\n    $('a.btn').attr('href', recipe.url);\n\n    for(let i = 0; i < recipe.ingredients.length ; i++){\n      $('.card-body .ingredients')\n        .append(`<li>- ${recipe.ingredients[i].text}</li>`)\n    }\n\n    $('.btn-prev').one('click', () => {\n\n      if (index > maxIndex - 4){\n        index--;\n        changeRecipe(data, index, maxIndex)\n      }else{\n        index = maxIndex;\n        changeRecipe(data, index, maxIndex)\n      }\n    });\n    $('.btn-next').one('click', () => {\n      if (index < maxIndex){\n        index++;\n        recipeNumber++;\n        changeRecipe(data, index,maxIndex)\n      }else{\n        recipeNumber = 1;\n        index = maxIndex - 4;\n        changeRecipe(data, index,maxIndex)\n      }\n    });\n  };\n  const clearRecipeData = ()=>{\n    $('ul.ingredients').empty();\n    $('.image').empty();\n  };\n\n  openFridge();\n  handleSelection();\n  $('.search').on('click',createRequest)\n});\n"]}